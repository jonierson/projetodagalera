<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página de Votação</title>
    <script>
        // Função para validar o e-mail
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(String(email).toLowerCase());
        }

        // Simulação do envio de e-mail de confirmação
        function sendConfirmationEmail(email) {
            console.log(`Enviando e-mail de confirmação para: ${email}`);
        }

        // Simulação da verificação de votos
        const votes = {};

        function hasVoted(email, projectId) {
            return votes[email] && votes[email].includes(projectId);
        }

        // Função para lidar com a submissão do formulário
        function submitVote(event) {
            event.preventDefault();
            const email = document.getElementById('emailInput').value;
            const selectedProjectId = document.getElementById('projectSelect').value;

            if (validateEmail(email)) {
                if (hasVoted(email, selectedProjectId)) {
                    alert("Você já votou nesse projeto.");
                } else {
                    sendConfirmationEmail(email);  // Enviar e-mail de confirmação
                    alert("Um e-mail de confirmação foi enviado. Por favor, confirme para registrar seu voto.");
                    // Registrar o voto apenas após a confirmação
                    if (!votes[email]) {
                        votes[email] = [];
                    }
                    votes[email].push(selectedProjectId);
                }
            } else {
                alert("Por favor, insira um e-mail válido.");
            }
        }
    </script>
</head>
<body>
    <h1>Votação de Projetos</h1>
    <form id="emailForm" onsubmit="submitVote(event)">
        <label for="emailInput">E-mail:</label>
        <input type="email" id="emailInput" required>
        <br><br>
        <label for="projectSelect">Selecione um Projeto:</label>
        <select id="projectSelect">
            <option value="projeto1">Projeto 1</option>
            <option value="projeto2">Projeto 2</option>
            <option value="projeto3">Projeto 3</option>
        </select>
        <br><br>
        <button type="submit">Votar</button>
    </form>
</body>
</html>
